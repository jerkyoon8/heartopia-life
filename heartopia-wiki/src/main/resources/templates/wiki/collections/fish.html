<!DOCTYPE html>
<html xmlns:th="http://www.thymeleaf.org">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Fish Collection - Heartopia Wiki</title>
    <!-- Pretendard Font -->
    <link rel="stylesheet" as="style" crossorigin
        href="https://cdn.jsdelivr.net/gh/orioncactus/pretendard@v1.3.9/dist/web/static/pretendard.min.css" />
    <!-- Bootstrap 5 -->
    <link href="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/css/bootstrap.min.css" rel="stylesheet">
    <!-- FontAwesome (Icons) -->
    <link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/6.4.0/css/all.min.css">
    <!-- Common CSS -->
    <link rel="stylesheet" href="/css/common.css">
    <!-- Wiki Filter JS -->
    <script src="/js/wiki-filter.js" defer></script>
</head>

<body>
    <!-- Navbar (Common Fragment) -->
    <div th:replace="~{fragments/header :: header}"></div>
    <div class="mw-body">
        <div class="page-header"><i class="fas fa-fish fa-2x text-primary"></i>
            <h1>생선 도감 (Fish Collection)</h1>
        </div>
        <p class="text-secondary mb-4">하트피아의 강과 바다에서 낚을 수 있는 다양한 생선들에 대한 정보입니다.</p>
        <!-- Filter Bar -->
        <div class="filter-bar">
            <!-- Search -->
            <div class="filter-group" style="flex-grow: 2;">
                <i class="fas fa-search text-secondary"></i>
                <input type="text" id="searchInput" class="search-input" placeholder="이름 검색...">
            </div>
            <!-- Filters -->
            <select id="levelFilter" class="filter-select">
                <option value="all">모든 레벨</option>
                <option value="1">Lv.1</option>
                <option value="2">Lv.2</option>
                <option value="3">Lv.3</option>
                <option value="4">Lv.4</option>
                <option value="5">Lv.5</option>
                <option value="6">Lv.6</option>
                <option value="7">Lv.7</option>
                <option value="8">Lv.8</option>
                <option value="9">Lv.9</option>
                <option value="10">Lv.10+</option>
            </select>
            <select id="locationFilter" class="filter-select">
                <option value="all">모든 장소</option>
                <!-- Options populated by JS -->
            </select>
            <select id="shadowFilter" class="filter-select">
                <option value="all">모든 그림자</option>
                <!-- Options populated by JS -->
            </select>

            <!-- Sort & Reset (Fragment) -->
            <div th:replace="~{fragments/wiki-components :: sortAndReset}"></div>
        </div>
        <div class="wiki-grid-layout" id="wikiGrid">
            <div class="no-results" id="noResults"><i class="fas fa-search fa-3x mb-3 text-muted"></i>
                <p>검색 결과가 없습니다.</p>
            </div>

            <!-- Fish Card Loop -->
            <div th:each="fish : ${fishList}" class="wiki-item-card" th:data-name="${fish.name}"
                th:data-level="${#strings.replace(fish.level, 'Lv.', '')}" th:data-location="${fish.location}"
                th:data-shadow="${fish.size}" th:data-price="${fish.prices[0]}">

                <div class="wiki-item-image">
                    <i class="fas fa-fish fa-4x text-primary" style="opacity: 0.7;"></i>
                </div>

                <div class="wiki-item-info">
                    <a href="#" class="wiki-item-name" th:text="${fish.name}">생선 이름</a>
                    <div>
                        <a th:href="@{/wiki/map(cat='fish', name=${fish.name})}" class="wiki-item-tag location-link">
                            <i class="fas fa-map-marker-alt me-1"></i>
                            <span th:text="${fish.location + ' - ' + fish.subLocation}">서식지</span>
                        </a>
                    </div>
                </div>

                <table class="wiki-item-stats">
                    <tr>
                        <td class="stat-label">가능 레벨</td>
                        <td class="stat-value"><span th:text="${fish.level}"></span>Lv.</td>
                    </tr>
                    <tr>
                        <td class="stat-label">날씨</td>
                        <td class="stat-value">
                            <span th:if="${fish.weather.contains('해')}" title="맑음"><i
                                    class="fas fa-sun text-warning me-1"></i></span>
                            <span th:if="${fish.weather.contains('비')}" title="비"><i
                                    class="fas fa-cloud-showers-heavy text-primary me-1"></i></span>
                            <span th:if="${fish.weather.contains('무지개')}" title="무지개"><i
                                    class="fas fa-rainbow text-info me-1"></i></span>
                            <span th:if="${fish.weather == '상시'}" th:text="${fish.weather}"></span>
                            <small class="text-muted" th:if="${fish.weather != '상시'}" th:text="${fish.weather}"></small>
                        </td>
                    </tr>
                    <tr>
                        <td class="stat-label">시간</td>
                        <td class="stat-value" th:text="${fish.time}">상시</td>
                    </tr>
                    <tr>
                        <td class="stat-label">사이즈</td>
                        <td class="stat-value" th:text="${fish.size}">중형</td>
                    </tr>
                </table>

                <!-- Price Fragment -->
                <div th:replace="~{fragments/wiki-components :: priceDisplay(${fish.prices})}"></div>
            </div>
        </div>
        <!-- Footer (Common Fragment) -->
        <div th:replace="~{fragments/footer :: footer}"></div>
        <script src="https://cdn.jsdelivr.net/npm/bootstrap@5.3.0/dist/js/bootstrap.bundle.min.js"></script>
        <script>
            document.addEventListener('DOMContentLoaded', function () {
                new WikiFilter({
                    gridId: 'wikiGrid',
                    itemSelector: '.wiki-item-card',
                    filters: [
                        { id: 'levelFilter', dataKey: 'level' },
                        { id: 'locationFilter', dataKey: 'location', autoPopulate: true },
                        { id: 'shadowFilter', dataKey: 'shadow', autoPopulate: true }
                    ]
                });
            });
        </script>
</body>

</html>